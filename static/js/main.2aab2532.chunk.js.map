{"version":3,"sources":["hooks/useLocation.tsx","hooks/usePins.tsx","hooks/useUser.tsx","AppProvider.tsx","components/Auth.tsx","lib/phonenumber.ts","img/plus.png","img/pin.png","img/fire.png","components/DropPin.tsx","components/Log.tsx","components/Map.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["arcgis","window","arcgisRest","authentication","ApiKey","key","mockUseLocation","locationAvailable","places","coords","lat","lng","getPlaces","Promise","r","mockUsePins","iter","pins","featureSet","type","features","distribution","pinErr","getPins","createPin","userExists","number","resolve","reject","a","fetch","req","json","poolDetails","ClientId","UserPoolId","mockUseUser","isAuthenticated","promptForCode","headers","get","post","authError","getCode","phoneNumber","answer","logout","defaultValue","freeze","user","location","AppContext","createContext","useApp","useContext","AppProvider","props","useState","frozen","setFrozen","authDetails","Pool","AmazonCognitoIdentity","getCurrentUser","accessToken","setAccessToken","refreshToken","setRefreshToken","setError","setIsAuthenticated","setPromptForCode","setAnswer","retrieveAccessTokens","getSession","error","session","getAccessToken","getJwtToken","RefreshToken","getRefreshToken","getToken","refreshSession","err","register","attrs","Name","Value","signUp","result","unfreeze","exists","Username","ClientMetadata","setAuthenticationFlowType","initiateAuth","onSuccess","onFailure","e","customChallenge","sendCustomChallengeAnswer","init","useEffect","signOut","useUser","setLocationAvailable","setPlaces","setLat","setLng","geocode","params","category","distance","maxLocations","outFields","response","candidates","console","log","success","pos","latitude","longitude","navigator","geolocation","getCurrentPosition","enableHighAccuracy","timeout","useLocation","setIter","setPins","setFeatureSet","setDistribution","data","total","reduce","acc","val","litness","addresses","includes","placeAddress","ranks","map","addy","filter","pin","list","dist","i","geoJson","geometry","coordinates","fromLonLat","properties","toString","placeName","body","method","JSON","stringify","usePins","value","Provider","className","children","Auth","stripped","rawNumber","setRawNumber","ref","useRef","autoComplete","placeholder","onClick","current","onChange","target","replaceAll","length","substr","reduced","Error","fmtPhoneNumber","DropPin","app","dropping","setDropping","loading","setLoading","setLitness","finish","alert","startDropping","place","attributes","PlaceName","Place_addr","src","fire","Log","style","display","feature","Style","image","CircleStyle","radius","parseInt","fill","Fill","color","Map","mapref","setMap","zoom","center","setCenter","options","view","OlView","minZoom","maxZoom","layers","OlTileLayer","source","OSM","OlVectorLayer","OlVectorSource","GeoJSON","readFeatures","controls","overlays","_map","OlMap","setTarget","getView","setZoom","getLayers","removeAt","opts","layer","push","id","undefined","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.2aab2532.chunk.js","sourcesContent":["import { useEffect, useState } from \"react\"\n\nconst apiKey = 'AAPK827c8d799c9f479bb6527fdfe01819026nJ4HXONEvXwkFIsjOMskDVGFYKeCgUGlZi9lgE2xnlQ7ROGR9D3ypGuaHv4XcNb';\nconst arcgis = (window as any).arcgisRest;\nlet authentication = new arcgis.ApiKey({\n  key: apiKey\n});\n\nexport interface LocationHook {\n  locationAvailable: boolean;\n  places: any;\n  coords: {\n    lat: number | null,\n    lng: number | null\n  };\n  getPlaces: () => Promise<void>;\n}\nexport const mockUseLocation:LocationHook = {\n  locationAvailable: false,\n  places: null,\n  coords: {\n    lat: null,\n    lng: null\n  },\n  getPlaces: () => new Promise (r => {})\n}\nexport default function useLocation ():LocationHook {\n  const [locationAvailable, setLocationAvailable] = useState<boolean> (false);\n  const [places, setPlaces] = useState<any> (null);\n  const [lat, setLat] = useState<number | null> (null);\n  const [lng, setLng] = useState<number | null> (null);\n\n  const getPlaces = async () => new Promise<void> (async (resolve, reject) => {\n    try {\n      let response = await arcgis.geocode ({\n        params: {\n          category: 'Arts and Entertainment,Coffee Shop,Nightlife Spot,Parks and Outdoors',\n          location: `${lng},${lat}`,\n          distance: 2000,\n          maxLocations: 6\n        },\n        outFields: '*',\n        authentication\n      })\n      setPlaces (response.candidates)\n      resolve ();\n    } catch (e) {\n      console.log (e);\n      reject ();\n    }\n  })\n\n  const success = (pos:GeolocationPosition) => {\n    setLat (pos.coords.latitude);\n    setLng (pos.coords.longitude);\n    setLocationAvailable (true);\n  }\n\n  const error = (e: any) => {\n    setLocationAvailable (false);\n    setLat (null);\n    setLng (null);\n    console.log ('#watch position error', e);\n  }\n\n  const init = () => {\n    let wid = window.navigator.geolocation.getCurrentPosition (success, error, {\n      enableHighAccuracy: true,\n      timeout: 1000\n    });\n    // return () => {\n    //   window.navigator.geolocation.clearWatch (wid);\n    // }\n  }\n\n  useEffect (init, []);\n\n  return {\n    locationAvailable,\n    places,\n    coords: {\n      lat,\n      lng\n    },\n    getPlaces\n  }\n}","import { fromLonLat } from \"ol/proj\";\nimport { useEffect, useState } from \"react\";\nimport { FreezeFn } from \"../AppProvider\";\nimport { LocationHook } from \"./useLocation\";\nimport { UserHook } from \"./useUser\";\n\ninterface Distribution {\n  [key: string]: number;\n}\n\ninterface Pin {\n  litness: number;\n  lat: number;\n  lng: number;\n  datetimeDropped: number;\n  placeName: string;\n  placeAddress: string;\n}\n\ninterface Feature {\n  type: string,\n  geometry: {\n    type: string,\n    coordinates: number[],\n  },\n  properties: any\n}\n\ninterface PointFeatureSet {\n  type: string;\n  features: Feature[];\n}\n\nexport interface PinsHook {\n  iter: number;\n  pins: Pin[];\n  featureSet: PointFeatureSet;\n  distribution: Distribution;\n  pinErr: null | string;\n  getPins: () => void;\n  createPin: (litness: number, placeName: string, placeAddress: string) => Promise<void>;\n}\n\nexport const mockUsePins:PinsHook = {\n  iter: 0,\n  pins: [],\n  featureSet: {\n    type: 'FeatureCollection',\n    features: []\n  },\n  distribution: {},\n  pinErr: null,\n  getPins: () => {},\n  createPin: ()=>new Promise (r => r)\n}\n\nexport default function usePins (user: UserHook, location: LocationHook, freeze: FreezeFn):PinsHook {\n  const [iter, setIter] = useState<number> (mockUsePins.iter);\n  const [pins, setPins] = useState<Pin[]> (mockUsePins.pins);\n  const [featureSet, setFeatureSet] = useState<PointFeatureSet> (mockUsePins.featureSet)\n  const [distribution, setDistribution] = useState<Distribution> ({});\n  const [pinErr, setError] = useState<null | string> (mockUsePins.pinErr);\n  const getPins = async () => {\n    try {\n      let req = await fetch (`https://1ge3owx5sf.execute-api.us-east-1.amazonaws.com/Prod/pins?lat=${location.coords.lat}&lng=${location.coords.lng}&r=0.1`);\n      let data = await req.json () as Pin[];\n      let total = data.reduce ((acc, val) => {\n        return acc + val.litness;\n      }, 0);\n      let addresses = data.reduce<string[]> ((acc, val) => {\n        if (acc.includes (val.placeAddress)) return acc;\n        return [...acc, val.placeAddress];\n      }, []);\n      let ranks = addresses.map (addy => data.filter (pin => pin.placeAddress === addy)).map (list => {\n        return list.reduce ((acc, val) => {\n          return acc + val.litness;\n        }, 0) / total;\n      });\n      let dist = addresses.reduce ((acc, val, i) => {\n        return {\n          ...acc,\n          [val]: ranks [i]\n        }\n      }, {});\n      setDistribution (dist);\n      const geoJson:PointFeatureSet = {\n        type: 'FeatureCollection',\n        features: data.map ((litness: Pin) => ({\n          type: 'Feature',\n          geometry: {\n            type: 'Point',\n            coordinates: fromLonLat ([litness.lng, litness.lat])\n          },\n          properties: {\n            ...litness\n          }\n        }))\n      }\n      setPins (data);\n      setFeatureSet (geoJson);\n      setIter (iter + 1);\n    } catch (e: any) {\n      setError (e?.toString () || 'unknown server error');\n    }\n  }\n  const createPin = (litness: number, placeName: string, placeAddress: string) => new Promise<void> (async (resolve, reject) => {\n    let unfreeze = freeze ();\n    try {\n      let body = {\n        ...location.coords,\n        litness,\n        placeName,\n        placeAddress\n      }\n      fetch ('https://1ge3owx5sf.execute-api.us-east-1.amazonaws.com/Prod/pins', {\n        method: 'post',\n        headers: user.headers.post,\n        body: JSON.stringify (body)\n      })\n    } catch (e: any) {\n      setError (e?.toString () || 'unknown error');\n    } finally {\n      unfreeze ();\n    }\n  })\n\n  useEffect (() => {\n    if (location.coords.lng && location.coords.lat) getPins ();\n  }, [location.coords.lng, location.coords.lat]);\n  \n  return {\n    iter,\n    pins,\n    featureSet,\n    distribution,\n    pinErr,\n    getPins,\n    createPin\n  }\n}","import * as AmazonCognitoIdentity from 'amazon-cognito-identity-js';\nimport { useEffect, useState } from 'react';\nimport { FreezeFn } from '../AppProvider';\n\n// get if number is in use\nconst userExists = (number:string) => new Promise<boolean> (async (resolve, reject) => {\n  try {\n    const req = await fetch (`https://1ge3owx5sf.execute-api.us-east-1.amazonaws.com/Prod/usernames/${number}`);\n    resolve (await req.json ());\n  } catch (e) {\n    reject (e);\n  }\n});\n\nconst poolDetails = {\n  ClientId: '2nl7v5gphbluvp0lhu8aooqhe3',\n  UserPoolId:\t'us-east-1_Xsf7vUqcY'\n}\n\ninterface AnswerFunction {\n  (answer: string): void;\n}\n\nexport interface UserHook {\n  isAuthenticated: boolean;\n  promptForCode: boolean;\n  headers: {\n    get: {\n      'x-amz-access-token'?: string\n    }\n    post: {\n      'Content-Type': string,\n      'x-amz-access-token'?: string\n    }\n  };\n  authError: string | null;\n  getCode: (phoneNumber: string) => void;\n  answer: AnswerFunction;\n  logout: () => Promise<void>;\n}\n\nexport const mockUseUser:UserHook = {\n  isAuthenticated: false,\n  promptForCode: false,\n  headers: {\n    get: {},\n    post: {\n      'Content-Type': ''\n    }\n  },\n  authError: null,\n  getCode: (phoneNumber: string) => {},\n  answer: (answer:string) => {},\n  logout: () => new Promise<void> (r => r())\n} \n\nexport default function useUser (freeze: FreezeFn):UserHook {\n  // local vars\n  let Pool = new AmazonCognitoIdentity.CognitoUserPool (poolDetails);\n  let user = Pool.getCurrentUser ();;\n  let authDetails:any;\n  // state so the headers work\n  const [accessToken, setAccessToken] = useState<string> ('');\n  const [refreshToken, setRefreshToken] = useState <AmazonCognitoIdentity.CognitoRefreshToken | null> (null);\n  // request headers\n  const headers = {\n    get: {\n      'x-amz-access-token': accessToken\n    },\n    post: {\n      'Content-Type': 'application/json',\n      'x-amz-access-token': accessToken\n    }\n  }\n\n  // state\n  const [authError, setError] = useState<string | null> (null);\n  const [isAuthenticated, setIsAuthenticated] = useState<boolean> (false);\n  const [promptForCode, setPromptForCode] = useState<boolean> (false);\n  const [answer, setAnswer] = useState<AnswerFunction> ((answer:string) => {});\n\n  // private method gets access and refresh tokens - call after authenticating \n  const retrieveAccessTokens = async () => {\n    if (user) user.getSession ((error:any, session:any) => {\n      if (error) return Promise.reject (error);\n      setAccessToken (session.getAccessToken ().getJwtToken ());\n      setRefreshToken (new AmazonCognitoIdentity.CognitoRefreshToken ({RefreshToken: session.getRefreshToken ().getToken ()}));\n      setIsAuthenticated (true);\n      return Promise.resolve ();\n    });\n    else return Promise.reject ('user dne');\n  }\n\n  // private method - refresh session should be called on init\n  const refreshSession = async () => {\n    if (user && refreshToken) user.refreshSession (refreshToken, (err: any) => {\n      if (err) return Promise.reject (err);\n      return retrieveAccessTokens ();\n    })\n  }\n\n  // public method - register user with username/password/email\n  const register = async (phoneNumber: string) => new Promise<void> (async (resolve, reject) => {\n    let attrs = [\n      new AmazonCognitoIdentity.CognitoUserAttribute ({\n        Name: 'phone_number',\n        Value: phoneNumber\n      })\n    ]\n    Pool.signUp (phoneNumber, 'Passwords are useless!', attrs, [], (err, result) => {\n      if (err) return reject (err);\n      if (result?.user) user = result.user;\n      return resolve ();\n    })\n  })\n\n  const getCode = async (phoneNumber:string) => {\n    let unfreeze = freeze ();\n    // check if user exists\n    let exists = true;\n    try {\n      exists = await userExists (phoneNumber);\n    } catch (e) {\n      setError ('error while checking if user exists');\n    }\n    // if user doesn't exist, register user\n    if (!exists) {  \n      try {\n        await register (phoneNumber);\n      } catch (e) {\n        setError ('error while registering user');\n        return;\n      } \n    }\n    authDetails = new AmazonCognitoIdentity.AuthenticationDetails ({Username: phoneNumber, ClientMetadata: {phoneNumber}});\n    user = new AmazonCognitoIdentity.CognitoUser ({Username: phoneNumber, Pool});\n    user.setAuthenticationFlowType ('CUSTOM_CHALLENGE');\n    user.initiateAuth (authDetails, {\n      onSuccess: () => {\n        retrieveAccessTokens ();\n        unfreeze ();\n      },\n      onFailure: e => {\n        setError (e);\n        unfreeze ();\n      },\n      customChallenge: function () {\n        setAnswer (() => (answer:string) => {\n          user?.sendCustomChallengeAnswer (answer, this);\n          unfreeze = freeze ();\n        })\n        setPromptForCode (true);\n      }\n    });\n  }\n  \n  // public method - sign user out\n  const logout = () => new Promise<void> (async (resolve, reject) => {\n    if (user) {\n      return resolve (user.signOut ());\n    }\n    else return reject ('user dne');\n  })\n\n  const init = async () => {\n    await retrieveAccessTokens ();\n    await refreshSession ();\n  }\n\n  useEffect (() => {\n    init ();\n  }, [])\n\n  return {\n    isAuthenticated,\n    promptForCode,\n    headers,\n    authError,\n    getCode,\n    answer,\n    logout\n  }\n\n}","import { createContext, useContext, useState } from \"react\";\nimport useLocation, { LocationHook, mockUseLocation } from \"./hooks/useLocation\";\nimport usePins, { mockUsePins, PinsHook } from \"./hooks/usePins\";\nimport useUser, { mockUseUser, UserHook } from \"./hooks/useUser\";\n\ninterface AppProviderProps {\n  children: JSX.Element\n}\n\nexport interface FreezeFn {\n  (): () => void;\n}\n\ninterface ContextValue {\n  freeze: FreezeFn;\n  user: UserHook;\n  pins: PinsHook;\n  location: LocationHook;\n}\n\nconst defaultValue:ContextValue = {\n  freeze: ()=>()=>{},\n  user: mockUseUser,\n  pins: mockUsePins,\n  location: mockUseLocation\n}\n\n// react context api\nconst AppContext = createContext<ContextValue> (defaultValue);\nexport const useApp = () => useContext (AppContext);\n\nexport default function AppProvider (props: AppProviderProps) {\n  \n  const [frozen, setFrozen] = useState<string> ('none');\n  const freeze = () => {\n    setFrozen ('frozen')\n\n    return function unfreeze () {\n      setFrozen ('none');\n    }\n  }\n\n  const user = useUser (freeze);\n  const location = useLocation ();\n  const pins = usePins (user, location, freeze);\n\n  const value:ContextValue = {\n    freeze,\n    user,\n    pins,\n    location\n  }\n\n  return (\n    <AppContext.Provider value={value}>\n      <div className={`freeze ${frozen}`} />\n      {props.children}\n    </AppContext.Provider>\n  )\n  \n}","import { useRef, useState } from \"react\";\nimport { useApp } from \"../AppProvider\";\nimport fmtPhoneNumber, { stripPhoneNumber } from \"../lib/phonenumber\";\n\nconst fmtRawPhoneNumber = (stripped:string) => {\n  if (stripped.length > 10) stripped = stripped.substr (0, 10);\n  if (stripped.length === 0) return stripped;\n  if (stripped.length < 4) return `(${stripped}`;\n  if (stripped.length < 7) return `(${stripped.substr (0, 3)}) ${stripped.substr (3)}`;\n  return `(${stripped.substr (0, 3)}) ${stripped.substr (3, 3)}-${stripped.substr (6)}`;\n}\n\nexport default function Auth () {\n  // global state\n  const {user: {isAuthenticated, promptForCode, authError, getCode, answer}} = useApp ();\n  // local state\n  const [rawNumber, setRawNumber] = useState<string> ('');\n  const ref = useRef<HTMLInputElement> (null);\n\n  if (isAuthenticated) return null;\n  if (promptForCode) return (\n    <div className=\"auth-container\">\n      <header>\n        <p>We texted you a code! Enter it here!</p>\n      </header>\n      <input ref={ref} autoComplete=\"one-time-code\" placeholder=\"Secret code here\" />\n      <button onClick={() => {if (ref.current?.value) answer (ref.current.value)}}>Send Code</button>\n    </div>\n  )\n  return (\n    <div className=\"auth-conatiner\">\n      <header>\n        <h1>Litness Sign In</h1>\n      </header>\n      {\n        authError &&\n        <div className=\"error\">{authError}</div>\n      }\n      <input type=\"text\" placeholder=\"(012) 345-6789\" autoComplete=\"off\" onChange={e => setRawNumber (stripPhoneNumber (e.target.value))} value={fmtRawPhoneNumber (rawNumber)} ></input>\n      <button onClick={() => {getCode (fmtPhoneNumber (rawNumber))}}>Sign In</button>\n    </div>\n  )\n}","export default (number:string) => {\n  let reduced = number.replaceAll (/[^0-9]/g, '');\n  if (reduced.length !== 10) throw new Error ('Phone number must be 10 digits, current length: ' + reduced.length);\n  return '+1' + reduced;\n}\n\nexport const stripPhoneNumber = (number:string) => number.replaceAll (/[^0-9]/g, '');","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/pin.c45e97d1.png\";","export default __webpack_public_path__ + \"static/media/fire.4fa412f3.png\";","import { useState } from \"react\";\nimport { useApp } from \"../AppProvider\";\nimport { fire, pin } from \"../img\";\n\nexport default function DropPin () {\n  const app = useApp ();\n\n  const [dropping, setDropping] = useState<boolean> (false);\n  const [loading, setLoading] = useState <boolean> (false);\n  const [litness, setLitness] = useState<number> (0);\n  \n  const finish = async (placeName: string, placeAddress:string) => {\n    try {\n      setDropping (false);\n      setLoading (false);\n      setLitness (0);\n      await app.pins.createPin (litness, placeName, placeAddress);\n    } catch (e: any) {\n      alert (e?.toString () || 'error while creating pin');\n    }\n  }\n\n  const startDropping = (litness: number) => async () => {\n    try {\n      setLoading (true);\n      setDropping (false);\n      setLitness (litness)\n      await app.location.getPlaces ();\n    } catch (e) {\n      alert ('error while getting nearby places');\n    }\n  }\n\n  if (!app.user.isAuthenticated || !app.location.locationAvailable) return null;\n  if (app.location.places && litness > 0) return (\n    <div className=\"drop-pin-backdrop\">\n      <div className=\"drop-pin place-list\">\n        <header>\n          <h1>Select current location:</h1>\n        </header>\n        {\n          app.location.places.map ((place:any) => (\n            <div onClick={() => finish (place.attributes.PlaceName, place.attributes.Place_addr)} className=\"drop-pin place\">\n              <h3>{place.attributes.PlaceName}</h3>\n            </div>\n          ))\n        }\n      </div>\n    </div>\n  )\n  if (loading) return (\n    <div className=\"drop-pin-backdrop\">\n      <div className=\"drop-pin place-list\">\n        <div className=\"drop-pin place placeholder\">\n          <header>\n            <h2></h2>\n          </header>\n        </div>\n        <div className=\"drop-pin place placeholder\">\n          <header>\n            <h2></h2>\n          </header>\n        </div>\n        <div className=\"drop-pin place placeholder\">\n          <header>\n            <h2></h2>\n          </header>\n        </div>\n        <div className=\"drop-pin place placeholder\">\n          <header>\n            <h2></h2>\n          </header>\n        </div>\n        <div className=\"drop-pin place placeholder\">\n          <header>\n            <h2></h2>\n          </header>\n        </div>\n      </div>\n    </div>\n  )\n  if (dropping) return (\n    <div className=\"drop-pin-backdrop\">\n      <div className=\"drop-pin-list\">\n        <button onClick={() => setDropping (false)} className=\"fire-button cancel\">X</button>\n        <button onClick={startDropping (1)} className=\"fire-button one\">\n          <img src={fire} />\n        </button>\n        <button onClick={startDropping (2)} className=\"fire-button two\">\n          <img src={fire} />\n          <img src={fire} />\n        </button>\n        <button onClick={startDropping (3)} className=\"fire-button three\">\n          <img src={fire} />\n          <img src={fire} />\n          <img src={fire} />\n        </button>\n        <button onClick={startDropping (4)} className=\"fire-button four\">\n          <img src={fire} />\n          <img src={fire} />\n          <img src={fire} />\n          <img src={fire} />\n        </button>\n        <button onClick={startDropping (5)} className=\"fire-button five\">\n          <img src={fire} />\n          <img src={fire} />\n          <img src={fire} />\n          <img src={fire} />\n          <img src={fire} />\n        </button>\n      </div>\n    </div>\n  )\n  return (\n    <button onClick={() => setDropping (true)} className=\"drop-pin-button\">\n      <img src={pin} />\n    </button>\n  )\n}","import { useApp } from \"../AppProvider\";\n\nexport default function Log () {\n  const app = useApp ();\n  \n  return (\n    <div style={{display: 'none'}}>\n      <ul>\n        <li>[{app.location.coords.lng}, {app.location.coords.lat}]</li>\n        {\n          app.pins.pins.map (pin => (\n            <li>{JSON.stringify (pin)}</li>\n          ))\n        }\n      </ul>\n    </div>\n  )\n}","import { useApp } from \"../AppProvider\";\nimport OlMap from 'ol/Map';\nimport OlView from 'ol/View';\nimport OlTileLayer from 'ol/layer/Tile';\nimport OlVectorLayer from 'ol/layer/Vector';\nimport OlVectorSource from 'ol/source/Vector';\nimport GeoJSON from 'ol/format/GeoJSON';\nimport OSM from 'ol/source/OSM';\nimport {Fill, Style} from 'ol/style';\nimport {fromLonLat} from 'ol/proj';\nimport { useEffect, useRef, useState } from \"react\";\nimport CircleStyle from \"ol/style/Circle\";\n\nconst style = (feature: any) => new Style ({\n  image: new CircleStyle ({\n    radius: parseInt (feature.get ('litness')) * 2,\n    fill: new Fill ({\n      color: [\n        255,\n        0,\n        0,\n        parseInt (feature.get ('litness')) / 25\n      ]\n    })\n  })\n})\n\nexport default function Map () {\n  const app = useApp ();\n  const mapref = useRef<HTMLDivElement> (null);\n  const [map, setMap] = useState<OlMap | null> (null);\n  const [zoom, setZoom] = useState <number> (16);\n  const [center, setCenter] = useState<number[] | null> (null);\n\n  useEffect (() => {\n\t\tconst options = {\n\t\t\tview: new OlView({ zoom, minZoom: zoom, maxZoom: zoom }),\n\t\t\tlayers: [\n        new OlTileLayer ({source: new OSM ()}),\n        new OlVectorLayer ({\n          source: new OlVectorSource ({\n            features: new GeoJSON().readFeatures(app.pins.featureSet),\n          })\n        })\n      ],\n\t\t\tcontrols: [],\n\t\t\toverlays: []\n\t\t};\n    const _map = new OlMap (options);\n    setMap (_map);\n  }, [])\n\n  useEffect (() => {\n    if (map && mapref.current) map.setTarget (mapref.current);\n  }, [app.location.locationAvailable]);\n\n  useEffect (() => {\n    if (map) {\n      map.getView ().setZoom (zoom);\n    }\n  }, [zoom]);\n\n  useEffect (() => {\n    if (center && map) {\n      map.getView ().setCenter (center);\n    }\n  }, [center]);\n\n  useEffect (() => {\n    if (app.location.coords.lat && app.location.coords.lng) setCenter (fromLonLat ([app.location.coords.lng, app.location.coords.lat]));\n  }, [app.location.coords.lat, app.location.coords.lng])\n\n  useEffect (() => {\n    map?.getLayers ().removeAt (1);\n    const opts = {\n      source: new OlVectorSource ({\n        features: new GeoJSON().readFeatures(app.pins.featureSet),\n      }),\n      style\n    }\n    const layer = new OlVectorLayer (opts);\n    console.log (app.pins.featureSet, layer, opts)\n    map?.getLayers ().push (layer);\n    \n  }, [app.pins.iter]);\n\n  return (\n    <div id=\"ol-map\" className={!app.user.isAuthenticated ? 'hidden' : undefined} ref={mapref} />\n  )\n}","import Auth from './components/Auth';\nimport DropPin from './components/DropPin';\nimport Log from './components/Log';\nimport Map from './components/Map';\n\nfunction App() {\n  return (\n    <>\n      <Auth />\n      <DropPin />\n      <Map />\n      <Log />\n    </>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport AppProvider from './AppProvider';\n\nReactDOM.render(\n  <React.StrictMode>\n    <AppProvider>\n      <App />\n    </AppProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}